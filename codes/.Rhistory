require(ggplot2)
require(stringr)
# require(dplyr)
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis"
dspath <- "~EnTrI/results/duplication_distance_calculator/distances"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
plot(ds, dii)
ds_quartiles <- c()
thresholds <- quantile(ds)
for (value in ds)
{
if (value < thresholds[2])
{
ds_quartiles <- c(ds_quartiles, 'New')
}
else if (value < thresholds[3])
{
ds_quartiles <- c(ds_quartiles, 'Older new')
}
else if (value < thresholds[4])
{
ds_quartiles <- c(ds_quartiles, 'Newer old')
}
else
{
ds_quartiles <- c(ds_quartiles, 'Old')
}
}
df <- data.frame(ds_quartiles, dii)
df$ds_quartiles <- factor(df$ds_quartiles,levels = c("New", "Older new", "Newer old", "Old"),ordered = TRUE)
ggplot(df)+geom_violin(aes(x=ds_quartiles,y=dii,group=ds_quartiles),color="black",fill="grey",size=2)+
theme(axis.text.x=element_text(colour="black"), axis.text.y=element_text(colour="black"))   # build the base violins
#http://stackoverflow.com/questions/22278951/combining-violin-plot-with-box-plot
require(ggplot2)
require(stringr)
# require(dplyr)
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis"
dspath <- "~EnTrI/results/duplication_distance_calculator/distances"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
plot(ds, dii)
ds_quartiles <- c()
thresholds <- quantile(ds)
for (value in ds)
{
if (value < thresholds[2])
{
ds_quartiles <- c(ds_quartiles, 'New')
}
else if (value < thresholds[3])
{
ds_quartiles <- c(ds_quartiles, 'Older new')
}
else if (value < thresholds[4])
{
ds_quartiles <- c(ds_quartiles, 'Newer old')
}
else
{
ds_quartiles <- c(ds_quartiles, 'Old')
}
}
df <- data.frame(ds_quartiles, dii)
df$ds_quartiles <- factor(df$ds_quartiles,levels = c("New", "Older new", "Newer old", "Old"),ordered = TRUE)
ggplot(df)+geom_violin(aes(x=ds_quartiles,y=dii,group=ds_quartiles),color="black",fill="grey",size=2)
require(ggplot2)
require(stringr)
# require(dplyr)
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis"
dspath <- "~EnTrI/results/duplication_distance_calculator/distances"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
plot(ds, dii)
ds_quartiles <- c()
thresholds <- quantile(ds)
for (value in ds)
{
if (value < thresholds[2])
{
ds_quartiles <- c(ds_quartiles, 'New')
}
else if (value < thresholds[3])
{
ds_quartiles <- c(ds_quartiles, 'Older new')
}
else if (value < thresholds[4])
{
ds_quartiles <- c(ds_quartiles, 'Newer old')
}
else
{
ds_quartiles <- c(ds_quartiles, 'Old')
}
}
df <- data.frame(ds_quartiles, dii)
df$ds_quartiles <- factor(df$ds_quartiles,levels = c("New", "Older new", "Newer old", "Old"),ordered = TRUE)
ggplot(df)
require(ggplot2)
require(stringr)
# require(dplyr)
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis"
dspath <- "~EnTrI/results/duplication_distance_calculator/distances"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
plot(ds, dii)
ds_quartiles <- c()
thresholds <- quantile(ds)
for (value in ds)
{
if (value < thresholds[2])
{
ds_quartiles <- c(ds_quartiles, 'New')
}
else if (value < thresholds[3])
{
ds_quartiles <- c(ds_quartiles, 'Older new')
}
else if (value < thresholds[4])
{
ds_quartiles <- c(ds_quartiles, 'Newer old')
}
else
{
ds_quartiles <- c(ds_quartiles, 'Old')
}
}
df <- data.frame(ds_quartiles, dii)
df$ds_quartiles <- factor(df$ds_quartiles,levels = c("New", "Older new", "Newer old", "Old"),ordered = TRUE)
require(ggplot2)
require(stringr)
# require(dplyr)
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis"
dspath <- "~EnTrI/results/duplication_distance_calculator/distances"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
plot(ds, dii)
ds_quartiles <- c()
thresholds <- quantile(ds)
for (value in ds)
{
if (value < thresholds[2])
{
ds_quartiles <- c(ds_quartiles, 'New')
}
else if (value < thresholds[3])
{
ds_quartiles <- c(ds_quartiles, 'Older new')
}
else if (value < thresholds[4])
{
ds_quartiles <- c(ds_quartiles, 'Newer old')
}
else
{
ds_quartiles <- c(ds_quartiles, 'Old')
}
}
df <- data.frame(ds_quartiles, dii)
df$ds_quartiles <- factor(df$ds_quartiles,levels = c("New", "Older new", "Newer old", "Old"),ordered = TRUE)
require(ggplot2)
require(stringr)
# require(dplyr)
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis"
dspath <- "~EnTrI/results/duplication_distance_calculator/distances"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
plot(ds, dii)
ds_quartiles <- c()
thresholds <- quantile(ds)
for (value in ds)
{
if (value < thresholds[2])
{
ds_quartiles <- c(ds_quartiles, 'New')
}
else if (value < thresholds[3])
{
ds_quartiles <- c(ds_quartiles, 'Older new')
}
else if (value < thresholds[4])
{
ds_quartiles <- c(ds_quartiles, 'Newer old')
}
else
{
ds_quartiles <- c(ds_quartiles, 'Old')
}
}
df <- data.frame(ds_quartiles, dii)
df$ds_quartiles <- factor(df$ds_quartiles,levels = c("New", "Older new", "Newer old", "Old"),ordered = TRUE)
ggplot(df)+geom_violin(aes(x=ds_quartiles,y=dii,group=ds_quartiles),color="black",fill="grey",size=2)+
theme(axis.text.x=element_text(colour="black"), axis.text.y=element_text(colour="black"))   # build the base violins
#http://stackoverflow.com/questions/22278951/combining-violin-plot-with-box-plot
require(ggplot2)
require(stringr)
# require(dplyr)
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis"
dspath <- "~EnTrI/results/duplication_distance_calculator/distances"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
ds
dii
require(ggplot2)
require(stringr)
# require(dplyr
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis/"
dspath <- "~/EnTrI/results/duplication_distance_calculator/distances/"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
require(ggplot2)
require(stringr)
# require(dplyr
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis/"
dspath <- "~/EnTrI/results/duplication_distance_calculator/distances/"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
require(ggplot2)
require(stringr)
# require(dplyr
diipath <- "~/EnTrI/results/duplication_distance_calculator/deltaiis/"
dspath <- "~/EnTrI/results/duplication_distance_calculator/distances/"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=F, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
plot(ds, dii)
ds_quartiles <- c()
thresholds <- quantile(ds)
for (value in ds)
{
if (value < thresholds[2])
{
ds_quartiles <- c(ds_quartiles, 'New')
}
else if (value < thresholds[3])
{
ds_quartiles <- c(ds_quartiles, 'Older new')
}
else if (value < thresholds[4])
{
ds_quartiles <- c(ds_quartiles, 'Newer old')
}
else
{
ds_quartiles <- c(ds_quartiles, 'Old')
}
}
df <- data.frame(ds_quartiles, dii)
df$ds_quartiles <- factor(df$ds_quartiles,levels = c("New", "Older new", "Newer old", "Old"),ordered = TRUE)
ggplot(df)+geom_violin(aes(x=ds_quartiles,y=dii,group=ds_quartiles),color="black",fill="grey",size=2)+
theme(axis.text.x=element_text(colour="black"), axis.text.y=element_text(colour="black"))   # build the base violins
#http://stackoverflow.com/questions/22278951/combining-violin-plot-with-box-plot
str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
plot(ds, dii)
reg1 <- lm(dii~ds)
abline(reg1)
plot(ds, dii, type="b")
plot(ds, dii, type="l")
plot(ds, dii, type="p")
pol2 <- function(x) fit2$coefficient[3]*x^2 + fit2$coefficient[2]*x + fit2$coefficient[1]
curve(pol2, col="red", lwd=2)
pol2 <- function(x) fit2$coefficient[3]*x^2 + fit2$coefficient[2]*x + fit2$coefficient[1]
curve(pol2, col="red", lwd=2)
lines(sort(ds), dii, col='red', type='b')
abline(regln, col="red")
regln <- lm(dii~ds)
plot(ds, dii)
abline(regln, col="red")
