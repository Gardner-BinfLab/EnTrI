axis(1, at=seq(0,4,1), cex.axis=1.5)
axis(2, at=seq(0,200,50), labels=c(0,NA,NA,NA,200), cex.axis=1.5)
legend(2.4,200, c("Essential","Non-essential", "Beneficial loss"), lty=c(1,1,1), lwd=c(4,4, 4),cex=1.15,
col=c("darkgoldenrod4","turquoise4", "darkmagenta"), bty="n")
lines(c(0.2, 0.2), c(-100,300), col = "red", lwd=3, lty = 2)
lines(c(2, 2), c(-100,300), col = "red", lwd=3, lty = 2)
orfans = c()
orfans_non = c()
orfans_es = c()
orfans_ben = c()
single_occurrence = c()
single_non = c()
single_es = c()
single_ben = c()
multiple_copies = c()
multiple_non = c()
multiple_es = c()
multiple_ben = c()
for (item in names(size_index))
{
if (size_index[item] <= 5)
{
orfans = c(orfans, insertion_index[item])
if (insertion_index[item] < 0.2)
orfans_es = c(orfans_es, insertion_index[item])
else if (insertion_index[item] < 2)
orfans_non = c(orfans_non, insertion_index[item])
else
orfans_ben = c(orfans_ben, insertion_index[item])
}
else if (size_index[item] <=  18)
{
single_occurrence = c(single_occurrence, insertion_index[item])
if (insertion_index[item] < 0.2)
single_es = c(single_es, insertion_index[item])
else if (insertion_index[item] < 2)
single_non = c(single_non, insertion_index[item])
else
single_ben = c(single_ben, insertion_index[item])
}
else
{
multiple_copies = c(multiple_copies, insertion_index[item])
if (insertion_index[item] < 0.2)
multiple_es = c(multiple_es, insertion_index[item])
else if (insertion_index[item] < 2)
multiple_non = c(multiple_non, insertion_index[item])
else
multiple_ben = c(multiple_ben, insertion_index[item])
}
}
h <- hist(orfans, breaks =seq(min(insertion_index),max(insertion_index)+1,0.02), plot = FALSE)
cuts <- cut(h$breaks, c(-Inf,0.18, 1.98, Inf))
screen(2)
par(mar=c(5.1,2.5,4.1,1))
plot(h, col=c("darkgoldenrod4", "turquoise4", "darkmagenta")[cuts], xlab=NA, ylab=NA, main ="ORFan", cex.axis=1.5, cex.main = 1.5,
xlim=c(0,4), ylim=c(0,150), lty= "blank", axes=FALSE)
axis(1, at=seq(0,4,1), cex.axis=1.5)
axis(2, at=seq(0,150,50), labels=c(0,NA,NA,150), cex.axis=1.5)
#legend(0.13,120, c("Essential","Non-essential", "Beneficial loss"), lty=c(1,1,1), bty="n",cex=1.5, lwd=c(4,4, 4),col=c("darkgoldenrod4","turquoise4", "darkmagenta"))
lines(c(0.2, 0.2), c(-100,300), col = "red", lwd=3, lty = 2)
lines(c(2, 2), c(-100,300), col = "red", lwd=3, lty = 2)
h <- hist(single_occurrence, breaks =seq(min(insertion_index),max(insertion_index)+1,0.02), plot = FALSE)
cuts <- cut(h$breaks, c(-Inf,0.18, 1.98, Inf))
screen(3)
par(mar=c(5.1,1,4.1,1))
plot(h, col=c("darkgoldenrod4", "turquoise4", "darkmagenta")[cuts], xlab=NA, ylab=NA, main ="Single copy", cex.axis=1.5, cex.main = 1.5,
xlim=c(0,4), ylim=c(0,150), lty= "blank", axes=FALSE)
axis(1, at=seq(0,4,1), cex.axis=1.5)
axis(2, at=seq(0,150,50), labels=c(NA,NA,NA,NA), cex.axis=1.5)
#legend(0.13,120, c("Essential","Non-essential", "Beneficial loss"), lty=c(1,1,1), bty="n",cex=1.5, lwd=c(4,4, 4),col=c("darkgoldenrod4","turquoise4", "darkmagenta"))
lines(c(0.2, 0.2), c(-100,300), col = "red", lwd=3, lty = 2)
lines(c(2, 2), c(-100,300), col = "red", lwd=3, lty = 2)
h <- hist(multiple_copies, breaks =seq(min(insertion_index),max(insertion_index)+1,0.02), plot = FALSE)
cuts <- cut(h$breaks, c(-Inf,0.18, 1.98, Inf))
screen(4)
#par(mar=c(2,1,2,1))
par(mar=c(5.1,1,4.1,1))
plot(h, col=c("darkgoldenrod4", "turquoise4", "darkmagenta")[cuts], xlab = NA, ylab=NA, main ="Multiple copy", cex.axis = 1.5, cex.main = 1.5,
xlim=c(0,4), ylim=c(0,150), lty= "blank", axes=FALSE)
axis(1, at=seq(0,4,1), cex.axis=1.5)
axis(2, at=seq(0,150,50), labels=c(NA,NA,NA,NA), cex.axis=1.5)
#legend(0.13,25, c("Essential","Non-essential", "Beneficial loss"), lty=c(1,1,1),cex=1.5, bty="n", lwd=c(4,4, 4),col=c("darkgoldenrod4","turquoise4", "darkmagenta"))
lines(c(0.2, 0.2), c(-100,300), col = "red", lwd=3, lty = 2)
lines(c(2, 2), c(-100,300), col = "red", lwd=3, lty = 2)
close.screen(all.screens = TRUE)
# dev.off()
# args <- commandArgs(trailingOnly = TRUE)
# clusters <- args[1]
clusters_path <- "../results/merge-clust-plot"
list_of_files <- list.files(path=clusters_path, full.names=T, recursive=FALSE)
file_II = list()
file_size = list()
for (filename in list_of_files)
{
cluster <- as.matrix(read.table(filename))
i_sum = 0
l_sum = 0
cluster_size = nrow(cluster)
clust_with_ii_size = 0
for (i in (1:cluster_size))
{
if (as.numeric(cluster[i,5]) >= 0)
{
i_sum = i_sum + as.numeric(cluster[i, 5])
l_sum = l_sum + (as.numeric(cluster[i, 4]) - as.numeric(cluster[i, 3]) + 1) * 3
clust_with_ii_size = clust_with_ii_size  + 1
}
}
if (l_sum > clust_with_ii_size * 60)
{
file_II[basename(filename)] = i_sum / clust_with_ii_size
file_size[basename(filename)] = cluster_size
}
}
insertion_index <- sapply(file_II, function(x){as.numeric(x[1])})
size_index <- sapply(file_size, function(x){as.numeric(x[1])})
# pdf("../results/cluster-essentiality.pdf")
m <- rbind(c(0,1,0.5,1), c(0, 0.34, 0, 0.5), c(0.34, 0.67, 0, 0.5), c(0.67, 1, 0, 0.5))
temp <- split.screen(m)
mar.default <- c(5,4,4,2) + 0.1
par(mar = mar.default + c(0, 1, 0, 0))
h <- hist(insertion_index, breaks =seq(min(insertion_index),max(insertion_index)+1,0.02), plot=FALSE)
cuts <- cut(h$breaks, c(-Inf,0.18, 1.98, Inf))
screen(1)
plot(h, col=c("darkgoldenrod4", "turquoise4", "darkmagenta")[cuts], xlab = "Insertion Index", main ="All clusters", cex.lab = 2,
cex.axis = 1.5, cex.main = 2, xlim=c(0,4), ylim=c(0,200), lty= "blank", axes=FALSE)
axis(1, at=seq(0,4,1), cex.axis=1.5)
axis(2, at=seq(0,200,50), labels=c(0,NA,NA,NA,200), cex.axis=1.5)
legend(2.4,200, c("Essential","Non-essential", "Beneficial loss"), lty=c(1,1,1), lwd=c(4,4, 4),cex=1.15,
col=c("darkgoldenrod4","turquoise4", "darkmagenta"), bty="n")
lines(c(0.2, 0.2), c(-100,300), col = "red", lwd=3, lty = 2)
lines(c(2, 2), c(-100,300), col = "red", lwd=3, lty = 2)
orfans = c()
orfans_non = c()
orfans_es = c()
orfans_ben = c()
single_occurrence = c()
single_non = c()
single_es = c()
single_ben = c()
multiple_copies = c()
multiple_non = c()
multiple_es = c()
multiple_ben = c()
for (item in names(size_index))
{
if (size_index[item] <= 5)
{
orfans = c(orfans, insertion_index[item])
if (insertion_index[item] < 0.2)
orfans_es = c(orfans_es, insertion_index[item])
else if (insertion_index[item] < 2)
orfans_non = c(orfans_non, insertion_index[item])
else
orfans_ben = c(orfans_ben, insertion_index[item])
}
else if (size_index[item] <=  18)
{
single_occurrence = c(single_occurrence, insertion_index[item])
if (insertion_index[item] < 0.2)
single_es = c(single_es, insertion_index[item])
else if (insertion_index[item] < 2)
single_non = c(single_non, insertion_index[item])
else
single_ben = c(single_ben, insertion_index[item])
}
else
{
multiple_copies = c(multiple_copies, insertion_index[item])
if (insertion_index[item] < 0.2)
multiple_es = c(multiple_es, insertion_index[item])
else if (insertion_index[item] < 2)
multiple_non = c(multiple_non, insertion_index[item])
else
multiple_ben = c(multiple_ben, insertion_index[item])
}
}
h <- hist(orfans, breaks =seq(min(insertion_index),max(insertion_index)+1,0.02), plot = FALSE)
cuts <- cut(h$breaks, c(-Inf,0.18, 1.98, Inf))
screen(2)
par(mar=c(5.1,2.5,4.1,1))
plot(h, col=c("darkgoldenrod4", "turquoise4", "darkmagenta")[cuts], xlab=NA, ylab=NA, main ="ORFan", cex.axis=1.5, cex.main = 1.5,
xlim=c(0,4), ylim=c(0,100), lty= "blank", axes=FALSE)
axis(1, at=seq(0,4,1), cex.axis=1.5)
axis(2, at=seq(0,100,50), labels=c(0,NA,100), cex.axis=1.5)
#legend(0.13,120, c("Essential","Non-essential", "Beneficial loss"), lty=c(1,1,1), bty="n",cex=1.5, lwd=c(4,4, 4),col=c("darkgoldenrod4","turquoise4", "darkmagenta"))
lines(c(0.2, 0.2), c(-100,300), col = "red", lwd=3, lty = 2)
lines(c(2, 2), c(-100,300), col = "red", lwd=3, lty = 2)
h <- hist(single_occurrence, breaks =seq(min(insertion_index),max(insertion_index)+1,0.02), plot = FALSE)
cuts <- cut(h$breaks, c(-Inf,0.18, 1.98, Inf))
screen(3)
par(mar=c(5.1,1,4.1,1))
plot(h, col=c("darkgoldenrod4", "turquoise4", "darkmagenta")[cuts], xlab=NA, ylab=NA, main ="Single copy", cex.axis=1.5, cex.main = 1.5,
xlim=c(0,4), ylim=c(0,100), lty= "blank", axes=FALSE)
axis(1, at=seq(0,4,1), cex.axis=1.5)
axis(2, at=seq(0,100,50), labels=c(NA,NA,NA), cex.axis=1.5)
#legend(0.13,120, c("Essential","Non-essential", "Beneficial loss"), lty=c(1,1,1), bty="n",cex=1.5, lwd=c(4,4, 4),col=c("darkgoldenrod4","turquoise4", "darkmagenta"))
lines(c(0.2, 0.2), c(-100,300), col = "red", lwd=3, lty = 2)
lines(c(2, 2), c(-100,300), col = "red", lwd=3, lty = 2)
h <- hist(multiple_copies, breaks =seq(min(insertion_index),max(insertion_index)+1,0.02), plot = FALSE)
cuts <- cut(h$breaks, c(-Inf,0.18, 1.98, Inf))
screen(4)
#par(mar=c(2,1,2,1))
par(mar=c(5.1,1,4.1,1))
plot(h, col=c("darkgoldenrod4", "turquoise4", "darkmagenta")[cuts], xlab = NA, ylab=NA, main ="Multiple copy", cex.axis = 1.5, cex.main = 1.5,
xlim=c(0,4), ylim=c(0,100), lty= "blank", axes=FALSE)
axis(1, at=seq(0,4,1), cex.axis=1.5)
axis(2, at=seq(0,100,50), labels=c(NA,NA,NA), cex.axis=1.5)
#legend(0.13,25, c("Essential","Non-essential", "Beneficial loss"), lty=c(1,1,1),cex=1.5, bty="n", lwd=c(4,4, 4),col=c("darkgoldenrod4","turquoise4", "darkmagenta"))
lines(c(0.2, 0.2), c(-100,300), col = "red", lwd=3, lty = 2)
lines(c(2, 2), c(-100,300), col = "red", lwd=3, lty = 2)
close.screen(all.screens = TRUE)
# dev.off()
require(ggplot2)
require(stringr)
# require(dplyr)
diipath <- "../results/duplication_distance_calculator/deltaiis/"
dspath <- "../results/duplication_distance_calculator/distances/"
list_of_files <- list.files(path=dspath, pattern="*.txt", full.names=FALSE, recursive=FALSE)
dii <- c()
ds <- c()
genes <- c()
for (filename in list_of_files)
{
dii_tbl <- read.table(paste(diipath,'/',filename,sep = ''), sep = '\t', header = FALSE)
ds_tbl <- read.table(paste(dspath,'/',filename,sep = ''), sep = '\t', header = FALSE)
for (i in seq(1,nrow(dii_tbl)))
{
if (i+2 <= ncol(dii_tbl))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
}
}
warnings()
View(dii_tbl)
View(dii_tbl)
View(ds_tbl)
View(ds_tbl)
dii
ds
View(dii_tbl)
View(dii_tbl)
dii_tbl[i,j]
i
j
dii_tbl[1,3]
seq(1,(nrow(dii_tbl)-1)
)
dii_tbl <- read.table('../results/duplication_distance_calculator/deltaiis/EFam000007.txt', sep = '\t', header = FALSE)
setwd("~/EnTrI/codes")
dii_tbl <- read.table('../results/duplication_distance_calculator/deltaiis/EFam000007.txt', sep = '\t', header = FALSE)
dii_tbl <- read.table('../results/duplication_distance_calculator/deltaiis/EFam-000007.txt', sep = '\t', header = FALSE)
ds_tbl <- read.table('../results/duplication_distance_calculator/distances/EFam-000007.txt', sep = '\t', header = FALSE)
for (i in seq(1,(nrow(dii_tbl)-1))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
dii_tbl <- read.table('../results/duplication_distance_calculator/deltaiis/EFam-000007.txt', sep = '\t', header = FALSE)
ds_tbl <- read.table('../results/duplication_distance_calculator/distances/EFam-000007.txt', sep = '\t', header = FALSE)
for (i in seq(1,(nrow(dii_tbl)-1))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
for (i in seq(1,(nrow(dii_tbl)-1))
{
for (j in seq(i+2, ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
nrow(dii_tbl)
for (i in seq(1,(nrow(dii_tbl)-1))
{}
for (i in seq(1,(nrow(dii_tbl)-1))
for (j in seq(i+2, ncol(dii_tbl)))
for (j in seq(i+2, ncol(dii_tbl)))
{for (j in seq(i+2, ncol(dii_tbl)))}
for (j in seq(i+2, ncol(dii_tbl)))
{for (j in seq(i+2, ncol(dii_tbl)))
{if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))}
}
}
for (i in seq(1,(nrow(dii_tbl)-1))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
for (i in seq(1,(nrow(dii_tbl)-1))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
for (i in seq(1,(nrow(dii_tbl)-1))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
print j
}
}
for (i in seq(1,(nrow(dii_tbl)-1))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
print (j)
}
}
for (i in seq(1,(nrow(dii_tbl)-1))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
c=1
}
}
for (i in seq(1,(nrow(dii_tbl)-1))
{print(i)}
for (i in seq(1,(nrow(dii_tbl)-1))
{print(i)
for (i in seq(1,(nrow(dii_tbl)-1))
{print(i)
seq(1,(nrow(dii_tbl)-1)
)
for (i in seq(1,(nrow(dii_tbl)-1)))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
if (dii_tbl[i,j] != -1 & str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2] ==
str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2])
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
View(dii_tbl)
View(dii_tbl)
View(ds_tbl)
View(ds_tbl)
str_match(dii_tbl[1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
str_match(dii_tbl[1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[1]
str_match(dii_tbl[1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[3]
str_match(dii_tbl[2,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genei = str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomei = str_match(genei, "([[:alpha:]]*)\\_[[:graph:]]+")[2]
genei = str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomei = str_match(genei, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
genei="b123"
genomei = str_match(genei, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
is.nan(genomei)
genomei
is.na(genomei)
genomei = str_match(genei, "([[:alpha:]]*)[[:digit:]]+")[2]
for (i in seq(1,(nrow(dii_tbl)-1)))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
genei = str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomei = str_match(genei, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
if (is.na(genomei))
{
genomei = str_match(genei, "([[:alpha:]]*)[[:digit:]]+")[2]
}
genej = str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
if (is.na(genomej))
{
genomej = str_match(genej, "([[:alpha:]]*)[[:digit:]]+")[2]
}
if (dii_tbl[i,j] != -1 & genomei  == genomej)
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
for (i in seq(1,(nrow(dii_tbl)-1)))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
genei = str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomei = str_match(genei, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
if (is.na(genomei))
{
genomei = str_match(genei, "([[:alpha:]]*)[[:digit:]]+")[2]
}
genej = str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomej = str_match(genej, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
if (is.na(genomej))
{
genomej = str_match(genej, "([[:alpha:]]*)[[:digit:]]+")[2]
}
if (dii_tbl[i,j] != -1 & genomei  == genomej)
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
dii <-c()
ds <- c()
genes <- c()
for (i in seq(1,(nrow(dii_tbl)-1)))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
genei = str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomei = str_match(genei, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
if (is.na(genomei))
{
genomei = str_match(genei, "([[:alpha:]]*)[[:digit:]]+")[2]
}
genej = str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomej = str_match(genej, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
if (is.na(genomej))
{
genomej = str_match(genej, "([[:alpha:]]*)[[:digit:]]+")[2]
}
if (dii_tbl[i,j] != -1 & genomei  == genomej)
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(dii_tbl[i,1], dii_tbl[j-1,1]))
}
}
}
View(genes)
dii_tbl <- read.table('../results/duplication_distance_calculator/deltaiis/EFam-000007.txt', sep = '\t', header = FALSE)
ds_tbl <- read.table('../results/duplication_distance_calculator/distances/EFam-000007.txt', sep = '\t', header = FALSE)
dii <- c()
ds <- c()
genes <- c()
for (i in seq(1,(nrow(dii_tbl)-1)))
{
for (j in seq((i+2), ncol(dii_tbl)))
{
genei = str_match(dii_tbl[i,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomei = str_match(genei, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
if (is.na(genomei))
{
genomei = str_match(genei, "([[:alpha:]]*)[[:digit:]]+")[2]
}
genej = str_match(dii_tbl[j-1,1], "([[:graph:]]*)\\_[[:digit:]]+\\-[[:digit:]]+")[2]
genomej = str_match(genej, "([[:alnum:]]*)\\_[[:graph:]]+")[2]
if (is.na(genomej))
{
genomej = str_match(genej, "([[:alpha:]]*)[[:digit:]]+")[2]
}
if (dii_tbl[i,j] != -1 & genomei  == genomej)
{
dii <- c(dii, dii_tbl[i,j])
ds <- c(ds, ds_tbl[i,j])
genes <- rbind(genes, c(genei, genej))
}
}
}
View(genes)
