library(stringr)
# listinput <- list(a=c(1,1,1,1,2,1,2,3,3,3), b=c(1,4,5), d=c(1,2,5,6,7), e=c(4,8,9))
# upset(fromList(listinput))
clusters_path <- "../results/merge-clust-plot"
list_of_files <- list.files(path=clusters_path, full.names=T, recursive=FALSE)
presence = list("ROD"=c(), "CS17"=c(), "ENC"=c(), "ETEC"=c(), "NCTC13441"=c(), "ERS227112"=c(), "BN373"=c(), "SEN"=c(), "STM"=c(),
"SL1344"=c(), "STMMW"=c(), "t"=c(), "b"=c())
essentiality = list("ROD"=c(), "CS17"=c(), "ENC"=c(), "ETEC"=c(), "NCTC13441"=c(), "ERS227112"=c(), "BN373"=c(), "SEN"=c(), "STM"=c(),
"SL1344"=c(), "STMMW"=c(), "t"=c(), "b"=c())
for (filename in list_of_files)
{
cluster <- as.matrix(read.table(filename))
cluster_size = nrow(cluster)
for (i in (1:cluster_size))
{
if (as.numeric(cluster[i,5]) >= 0)
{
match = str_match(cluster[i,2], "([[:graph:]]+)\\_[[:alnum:]]+")[2]
if (is.na(match))
{
match = str_match(cluster[i,2], "([[:alpha:]]+)[[:digit:]]+")[2]
}
if (match %in% names(presence))
{
presence[[match]] = c(presence[[match]], strsplit(basename(filename),"\\.")[[1]][1])
if (as.numeric(cluster[i,5]) < 0.2)
{
essentiality[[match]] = c(essentiality[[match]], strsplit(basename(filename),"\\.")[[1]][1])
}
}
}
}
}
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(essentiality), nsets = 13, order.by="freq", nintersects=51)
names(presence)
names(presence) <- c("Citrobacter", "EC_ETEC_CS17", "Enterobacter", "EC_ETEC_H10407", "EC_UPEC",
"KP_RH201207", "KP_Ecl8", "S_enteritidis", "S_typhimurium_A130",
"S_typhimurium_SL1344", "S_typhimurium_D23580", "S_typhi")
names(essentiality) <- c("Citrobacter", "EC_ETEC_CS17", "Enterobacter", "EC_ETEC_H10407", "EC_UPEC",
"KP_RH201207", "KP_Ecl8", "S_enteritidis", "S_typhimurium_A130",
"S_typhimurium_SL1344", "S_typhimurium_D23580", "S_typhi")
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(essentiality), nsets = 13, order.by="freq", nintersects=51)
names(presence) <- c("Citrobacter", "EC_ETEC_CS17", "Enterobacter", "EC_ETEC_H10407", "EC_UPEC",
"KP_RH201207", "KP_Ecl8", "S_enteritidis", "S_typhimurium_A130",
"S_typhimurium_SL1344", "S_typhimurium_D23580", "S_typhi", "EC_k12")
names(essentiality) <- c("Citrobacter", "EC_ETEC_CS17", "Enterobacter", "EC_ETEC_H10407", "EC_UPEC",
"KP_RH201207", "KP_Ecl8", "S_enteritidis", "S_typhimurium_A130",
"S_typhimurium_SL1344", "S_typhimurium_D23580", "S_typhi", "EC_k12")
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(essentiality), nsets = 13, order.by="freq", nintersects=51)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66, number.angles=90)
upset(fromList(essentiality), nsets = 13, order.by="freq", nintersects=51, number.angles=90)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66, number.angles=-90)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66, number.angles=45)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66, number.angles=180)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66, number.angles=270)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(essentiality), nsets = 13, order.by="freq", nintersects=51)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66, group.by = "sets")
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(essentiality), nsets = 13, order.by="freq", nintersects=51)
329*4
329*5
rnaseq<-read.table("rnaseq.plot", header = F, sep = "\t")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-read.table("bounds.dat",         header = F, sep = "\t")
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-bounds+x1
pdf(file="RNAseq.pdf",width=10, height=5)
par(mar=rep(0, 4), xpd = NA)
#par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  rnaseq[,1]+rnaseq[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(rnaseq[,1]+rnaseq[,2]))) )#ylim=c(0,20000))#
setwd("~/Desktop/paul-figure")
rnaseq<-read.table("rnaseq.plot", header = F, sep = "\t")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-read.table("bounds.dat",         header = F, sep = "\t")
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-bounds+x1
pdf(file="RNAseq.pdf",width=10, height=5)
par(mar=rep(0, 4), xpd = NA)
#par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  rnaseq[,1]+rnaseq[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(rnaseq[,1]+rnaseq[,2]))) )#ylim=c(0,20000))#
rnaseq<-read.table("rnaseq.plot", header = F, sep = "\t")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-read.table("bounds.dat",         header = F, sep = "\t")
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-bounds+x1
pdf(file="RNAseq.pdf",width=10, height=5)
par(mar=rep(0, 4), xpd = NA)
#par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  rnaseq[,1]+rnaseq[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(rnaseq[,1]+rnaseq[,2]))) )#ylim=c(0,20000))#
dev.off()
dev.off()
dev.off()
rnaseq<-read.table("rnaseq.plot", header = F, sep = "\t")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-read.table("bounds.dat",         header = F, sep = "\t")
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-bounds+x1
pdf(file="RNAseq.pdf",width=10, height=5)
par(mar=rep(0, 4), xpd = NA)
#par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  rnaseq[,1]+rnaseq[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(rnaseq[,1]+rnaseq[,2]))) )#ylim=c(0,20000))#
#lines(bounds, rnaseq[,2], col="red",lwd=3)
#legend(x1,max(c(rnaseq[,1],rnaseq[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
#legend(x1,max(c(rnaseq[,1],rnaseq[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
dev.off()
pdf(file="RNAseq-col.pdf",width=10, height=7)
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  rnaseq[,1],type="l", col="red", main="RNA-seq and annotations", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(rnaseq[,1],rnaseq[,2]))))
lines(bounds, rnaseq[,2], col="green",lwd=3)
legend(x1,max(c(rnaseq[,1],rnaseq[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
legend(x1,max(c(rnaseq[,1],rnaseq[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
for (i in c(1:length(annot$V1))){
col<-'lightblue'
if (annot$V5[i]=='misc_RNA')   col<-'pink'
if (annot$V5[i]=='terminator') col<-'salmon'
if (annot$V5[i]=='domain')     col<-'grey'
pos<-3
if (annot$V5[i]=='domain')     pos<-1
ycoord<-1
arrowcoords<-c(annot$V1[i], annot$V2[i])
if (annot$V3[i]=='-'){
ycoord<--1
arrowcoords<-c(annot$V2[i], annot$V1[i])
}
code<-2
#if (annot$V5[i]=='terminator') code<-1
lines(c(annot$V1[i], annot$V2[i]), c(ycoord,ycoord), col=col, lwd=10)
arrows(arrowcoords[1],ycoord,arrowcoords[2],ycoord,code=code,col='black',lwd=2,length=0.1 )
midX<-annot$V1[i]+(annot$V2[i]-annot$V1[i])/2
text(midX,ycoord,annot$V4[i],cex=1.0,pos=pos)
}
dev.off()
rnaseq
plot(bounds)
plot(bounds, rnaseq[,1])
plot(bounds, rnaseq[,1], type='l')
plot(bounds,  rnaseq[,1],type="l", col="red", main="RNA-seq and annotations", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(rnaseq[,1],rnaseq[,2]))))
lines(bounds, rnaseq[,2], col="green",lwd=3)
legend(x1,max(c(rnaseq[,1],rnaseq[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
legend(x1,max(c(rnaseq[,1],rnaseq[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  rnaseq[,1],type="l", col="red", main="RNA-seq and annotations", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(rnaseq[,1],rnaseq[,2]))))
lines(bounds, rnaseq[,2], col="green",lwd=3)
legend(x1,max(c(rnaseq[,1],rnaseq[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
legend(x1,max(c(rnaseq[,1],rnaseq[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
58747-57343
bounds$V1
tradis<-read.table("TraDIS.plot", header = F, sep = "\t")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-read.table("tbounds.dat",         header = F, sep = "\t")
plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(rnaseq[,1]+rnaseq[,2]))) )#ylim=c(0,20000))#
tradis
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-read.table("tbounds.dat",         header = F, sep = "\t")
plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(rnaseq[,1]+rnaseq[,2]))) )#ylim=c(0,20000))#
plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
plot(bounds)
bounds
plot(bounds,  tradis[,1]+tradis[,2])
tradis[,1]
tradis[,2]
tradis[,1]+tradis[,2]
bounds <-read.table("bounds.dat",         header = F, sep = "\t")
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-bounds+x1
plot(bounds)
bounds <-read.table("tbounds.dat",         header = F, sep = "\t")
plot(bounds)
View(annot)
View(annot)
View(bounds)
int(bounds)
int(bounds[1])
plot(bounds[1])
bounds <-read.table("bounds.dat",         header = F, sep = "\t")
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-bounds+x1
bounds <- c(bounds)
bounds
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-bounds+x1
plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-bounds+x1
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(rnaseq[,1]),by=1)
bounds<-seq(1,length(tradis[,1]),by=1)
bounds<-bounds+x1
plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  tradis[,1],type="l", col="red", main="RNA-seq and annotations", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(tradis[,1],tradis[,2]))))
lines(bounds, tradis[,2], col="green",lwd=3)
legend(x1,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
legend(x1,max(c(tradis[,1],tradis[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(tradis[,1]),by=1)
bounds<-bounds+x1
#plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  tradis[,1],type="l", col="red", main="TraDIS and annotations", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(tradis[,1],tradis[,2]))))
lines(bounds, tradis[,2], col="green",lwd=3)
#legend(x1,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
#legend(x1,max(c(tradis[,1],tradis[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(tradis[,1]),by=1)
bounds<-bounds+x1
#plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  tradis[,1],type="l", col="red", main="TraDIS and annotations", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(tradis[,1],tradis[,2]))))
lines(bounds, tradis[,2], col="green",lwd=3)
legend(x1,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
legend(x1,max(c(tradis[,1],tradis[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
for (i in c(1:length(annot$V1))){
col<-'lightblue'
if (annot$V5[i]=='misc_RNA')   col<-'pink'
if (annot$V5[i]=='terminator') col<-'salmon'
if (annot$V5[i]=='domain')     col<-'grey'
pos<-3
if (annot$V5[i]=='domain')     pos<-1
ycoord<-1
arrowcoords<-c(annot$V1[i], annot$V2[i])
if (annot$V3[i]=='-'){
ycoord<--1
arrowcoords<-c(annot$V2[i], annot$V1[i])
}
code<-2
lines(c(annot$V1[i], annot$V2[i]), c(ycoord,ycoord), col=col, lwd=10)
arrows(arrowcoords[1],ycoord,arrowcoords[2],ycoord,code=code,col='black',lwd=2,length=0.1 )
midX<-annot$V1[i]+(annot$V2[i]-annot$V1[i])/2
text(midX,ycoord,annot$V4[i],cex=1.0,pos=pos)
}
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(tradis[,1]),by=1)
bounds<-bounds+x1
#plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  tradis[,1],type="l", col="red", main="Salmonella Typhimurium SL1344", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(tradis[,1],tradis[,2]))))
lines(bounds, tradis[,2], col="green",lwd=3)
legend(x1,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
#legend(x1,max(c(tradis[,1],tradis[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
for (i in c(1:length(annot$V1))){
col<-'lightblue'
if (annot$V5[i]=='misc_RNA')   col<-'pink'
if (annot$V5[i]=='terminator') col<-'salmon'
if (annot$V5[i]=='domain')     col<-'grey'
pos<-3
if (annot$V5[i]=='domain')     pos<-1
ycoord<-1
arrowcoords<-c(annot$V1[i], annot$V2[i])
if (annot$V3[i]=='-'){
ycoord<--1
arrowcoords<-c(annot$V2[i], annot$V1[i])
}
code<-2
lines(c(annot$V1[i], annot$V2[i]), c(ycoord,ycoord), col=col, lwd=10)
arrows(arrowcoords[1],ycoord,arrowcoords[2],ycoord,code=code,col='black',lwd=2,length=0.1 )
midX<-annot$V1[i]+(annot$V2[i]-annot$V1[i])/2
text(midX,ycoord,annot$V4[i],cex=1.0,pos=pos)
}
legend(x2-1000,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
legend(x2-1000,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(tradis[,1]),by=1)
bounds<-bounds+x1
#plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  tradis[,1],type="l", col="red", main="Salmonella Typhimurium SL1344", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(tradis[,1],tradis[,2]))))
lines(bounds, tradis[,2], col="green",lwd=3)
legend(x2-1000,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3)
#legend(x1,max(c(tradis[,1],tradis[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
for (i in c(1:length(annot$V1))){
col<-'lightblue'
if (annot$V5[i]=='misc_RNA')   col<-'pink'
if (annot$V5[i]=='terminator') col<-'salmon'
if (annot$V5[i]=='domain')     col<-'grey'
pos<-3
if (annot$V5[i]=='domain')     pos<-1
ycoord<-1
arrowcoords<-c(annot$V1[i], annot$V2[i])
if (annot$V3[i]=='-'){
ycoord<--1
arrowcoords<-c(annot$V2[i], annot$V1[i])
}
code<-2
lines(c(annot$V1[i], annot$V2[i]), c(ycoord,ycoord), col=col, lwd=10)
arrows(arrowcoords[1],ycoord,arrowcoords[2],ycoord,code=code,col='black',lwd=2,length=0.1 )
midX<-annot$V1[i]+(annot$V2[i]-annot$V1[i])/2
text(midX,ycoord,annot$V4[i],cex=1.0,pos=pos)
}
?legend
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(tradis[,1]),by=1)
bounds<-bounds+x1
#plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  tradis[,1],type="l", col="red", main="Salmonella Typhimurium SL1344", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(tradis[,1],tradis[,2]))))
lines(bounds, tradis[,2], col="green",lwd=3)
legend(x2,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3, xjust = 1)
#legend(x1,max(c(tradis[,1],tradis[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
for (i in c(1:length(annot$V1))){
col<-'lightblue'
if (annot$V5[i]=='misc_RNA')   col<-'pink'
if (annot$V5[i]=='terminator') col<-'salmon'
if (annot$V5[i]=='domain')     col<-'grey'
pos<-3
if (annot$V5[i]=='domain')     pos<-1
ycoord<-1
arrowcoords<-c(annot$V1[i], annot$V2[i])
if (annot$V3[i]=='-'){
ycoord<--1
arrowcoords<-c(annot$V2[i], annot$V1[i])
}
code<-2
lines(c(annot$V1[i], annot$V2[i]), c(ycoord,ycoord), col=col, lwd=10)
arrows(arrowcoords[1],ycoord,arrowcoords[2],ycoord,code=code,col='black',lwd=2,length=0.1 )
midX<-annot$V1[i]+(annot$V2[i]-annot$V1[i])/2
text(midX,ycoord,annot$V4[i],cex=1.0,pos=pos)
}
tradis<-read.table("TraDIS.plot", header = F, sep = " ")
annot  <-read.table("annotation.dat",         header = F, sep = "\t")
bounds <-c(read.table("tbounds.dat",         header = F, sep = "\t"))
x1<-bounds$V1
x2<-bounds$V2
bounds<-seq(1,length(tradis[,1]),by=1)
bounds<-bounds+x1
#plot(bounds,  tradis[,1]+tradis[,2],type="l", col="black", lwd=9, xaxt="n", yaxt="n",bty ="n",axes=F,frame.plot=F, ann=FALSE, ylim=c(0,max(c(tradis[,1]+tradis[,2]))) )#ylim=c(0,20000))#
pdf(file="TraDIS.pdf",width=10, height=7)
par(fig=c(0.0,1.0,0.15,1.0),las=1)
plot(bounds,  tradis[,1],type="l", col="red", main="Salmonella Typhimurium SL1344", ylab="Read counts",xlab="",lwd=3, xaxt="n", ylim=c(0,max(c(tradis[,1],tradis[,2]))))
lines(bounds, tradis[,2], col="green",lwd=3)
legend(x2,max(c(tradis[,1],tradis[,2])), c("+ve strand", "-ve strand"),col=c("green","red"), lwd=3, xjust = 1)
#legend(x1,max(c(tradis[,1],tradis[,2]))/4, c("CDSs", "Pfam domain", "ncRNAs", "terminators"),col=c('lightblue','grey', 'pink','salmon'), lwd=10,ncol=2)
par(fig=c(0.0,1.0,0.0,0.4),las=1,new=TRUE)
plot(c(bounds[1],bounds[length(bounds)]), c(bounds[1],bounds[length(bounds)])*0, type="p", col="black", main="", ylab="",xlab="genome coordinate",lwd=1,ylim=c(-3,3), yaxt="n",pch=26)
for (i in c(1:length(annot$V1))){
col<-'lightblue'
if (annot$V5[i]=='misc_RNA')   col<-'pink'
if (annot$V5[i]=='terminator') col<-'salmon'
if (annot$V5[i]=='domain')     col<-'grey'
pos<-3
if (annot$V5[i]=='domain')     pos<-1
ycoord<-1
arrowcoords<-c(annot$V1[i], annot$V2[i])
if (annot$V3[i]=='-'){
ycoord<--1
arrowcoords<-c(annot$V2[i], annot$V1[i])
}
code<-2
lines(c(annot$V1[i], annot$V2[i]), c(ycoord,ycoord), col=col, lwd=10)
arrows(arrowcoords[1],ycoord,arrowcoords[2],ycoord,code=code,col='black',lwd=2,length=0.1 )
midX<-annot$V1[i]+(annot$V2[i]-annot$V1[i])/2
text(midX,ycoord,annot$V4[i],cex=1.0,pos=pos)
}
dev.off()
library("UpSetR")
library(stringr)
# listinput <- list(a=c(1,1,1,1,2,1,2,3,3,3), b=c(1,4,5), d=c(1,2,5,6,7), e=c(4,8,9))
# upset(fromList(listinput))
clusters_path <- "../results/merge-clust-plot"
list_of_files <- list.files(path=clusters_path, full.names=T, recursive=FALSE)
presence = list("ROD"=c(), "CS17"=c(), "ENC"=c(), "ETEC"=c(), "NCTC13441"=c(), "ERS227112"=c(), "BN373"=c(), "SEN"=c(), "STM"=c(),
"SL1344"=c(), "STMMW"=c(), "t"=c(), "b"=c())
essentiality = list("ROD"=c(), "CS17"=c(), "ENC"=c(), "ETEC"=c(), "NCTC13441"=c(), "ERS227112"=c(), "BN373"=c(), "SEN"=c(), "STM"=c(),
"SL1344"=c(), "STMMW"=c(), "t"=c(), "b"=c())
for (filename in list_of_files)
{
cluster <- as.matrix(read.table(filename))
cluster_size = nrow(cluster)
for (i in (1:cluster_size))
{
if (as.numeric(cluster[i,5]) >= 0)
{
match = str_match(cluster[i,2], "([[:graph:]]+)\\_[[:alnum:]]+")[2]
if (is.na(match))
{
match = str_match(cluster[i,2], "([[:alpha:]]+)[[:digit:]]+")[2]
}
if (match %in% names(presence))
{
presence[[match]] = c(presence[[match]], strsplit(basename(filename),"\\.")[[1]][1])
if (as.numeric(cluster[i,5]) < 0.2)
{
essentiality[[match]] = c(essentiality[[match]], strsplit(basename(filename),"\\.")[[1]][1])
}
}
}
}
}
names(presence) <- c("Citrobacter", "EC_ETEC_CS17", "Enterobacter", "EC_ETEC_H10407", "EC_UPEC",
"KP_RH201207", "KP_Ecl8", "S_enteritidis", "S_typhimurium_A130",
"S_typhimurium_SL1344", "S_typhimurium_D23580", "S_typhi", "EC_k12")
names(essentiality) <- c("Citrobacter", "EC_ETEC_CS17", "Enterobacter", "EC_ETEC_H10407", "EC_UPEC",
"KP_RH201207", "KP_Ecl8", "S_enteritidis", "S_typhimurium_A130",
"S_typhimurium_SL1344", "S_typhimurium_D23580", "S_typhi", "EC_k12")
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(essentiality), nsets = 13, order.by="freq", nintersects=51)
setwd("~/EnTrI/codes")
library("UpSetR")
library(stringr)
# listinput <- list(a=c(1,1,1,1,2,1,2,3,3,3), b=c(1,4,5), d=c(1,2,5,6,7), e=c(4,8,9))
# upset(fromList(listinput))
clusters_path <- "../results/merge-clust-plot"
list_of_files <- list.files(path=clusters_path, full.names=T, recursive=FALSE)
presence = list("ROD"=c(), "CS17"=c(), "ENC"=c(), "ETEC"=c(), "NCTC13441"=c(), "ERS227112"=c(), "BN373"=c(), "SEN"=c(), "STM"=c(),
"SL1344"=c(), "STMMW"=c(), "t"=c(), "b"=c())
essentiality = list("ROD"=c(), "CS17"=c(), "ENC"=c(), "ETEC"=c(), "NCTC13441"=c(), "ERS227112"=c(), "BN373"=c(), "SEN"=c(), "STM"=c(),
"SL1344"=c(), "STMMW"=c(), "t"=c(), "b"=c())
for (filename in list_of_files)
{
cluster <- as.matrix(read.table(filename))
cluster_size = nrow(cluster)
for (i in (1:cluster_size))
{
if (as.numeric(cluster[i,5]) >= 0)
{
match = str_match(cluster[i,2], "([[:graph:]]+)\\_[[:alnum:]]+")[2]
if (is.na(match))
{
match = str_match(cluster[i,2], "([[:alpha:]]+)[[:digit:]]+")[2]
}
if (match %in% names(presence))
{
presence[[match]] = c(presence[[match]], strsplit(basename(filename),"\\.")[[1]][1])
if (as.numeric(cluster[i,5]) < 0.2)
{
essentiality[[match]] = c(essentiality[[match]], strsplit(basename(filename),"\\.")[[1]][1])
}
}
}
}
}
names(presence) <- c("Citrobacter", "EC_ETEC_CS17", "Enterobacter", "EC_ETEC_H10407", "EC_UPEC",
"KP_RH201207", "KP_Ecl8", "S_enteritidis", "S_typhimurium_A130",
"S_typhimurium_SL1344", "S_typhimurium_D23580", "S_typhi", "EC_k12")
names(essentiality) <- c("Citrobacter", "EC_ETEC_CS17", "Enterobacter", "EC_ETEC_H10407", "EC_UPEC",
"KP_RH201207", "KP_Ecl8", "S_enteritidis", "S_typhimurium_A130",
"S_typhimurium_SL1344", "S_typhimurium_D23580", "S_typhi", "EC_k12")
upset(fromList(presence), nsets = 13, order.by="freq", nintersects=66)
upset(fromList(essentiality), nsets = 13, order.by="freq", nintersects=51)
